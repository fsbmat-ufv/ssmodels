<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ssmodels: A package for fit the sample selection models • ssmodels</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ssmodels: A package for fit the sample selection models">
<meta property="og:description" content="ssmodels">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ssmodels</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette.html">ssmodels: A package for fit the sample selection models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ssmodels: A package for fit the sample selection models</h1>
            
      
      
      <div class="hidden name"><code>vignette.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p style="text-align: justify;">
Com o objetivo de facilitar o ajuste dos modelos de seleção amostral existentes na literatura, criamos o pacote ssmodels. Nosso pacote permite o ajuste do modelo de Heckman clássico, e a estimação dos parâmetros desse modelo via método de máxima verossimilhança e método de dois passos, além do ajuste dos modelos Heckman-t, introduzido na literatura em 2012 por <span class="citation">Marchenko and Genton (2012)</span> e do modelo Heckman-Skew introduzido na literatura por <span class="citation">Ogundimu and Hutton (2016)</span> em 2016. Implementamos, ainda, funções para o ajuste da versão generalizada do modelo de Heckman que permite a inclusão de covariáveis aos parâmetros de dispersão e correlação e uma função para o ajuste do modelo Heckman-BS que utiliza a distribuição Birnbaum-Saunders como distribuição conjunta das variáveis de seleção e regressão primária.
</p>
<p style="text-align: justify;">
Comparamos nesse texto os resultados obtidos com o ajuste das funções do nosso pacote e funções do pacote sampleSelection de <span class="citation">Toomet and Henningsen (2008)</span> a dados simulados e também a banco de dados reais que foram incluídos no pacote.
</p>
</div>
<div id="modelo-de-heckman-generalizado" class="section level1">
<h1 class="hasAnchor">
<a href="#modelo-de-heckman-generalizado" class="anchor"></a>Modelo de Heckman Generalizado</h1>
<div id="simulated-data-with-fixed-dispersion-and-correlation" class="section level2">
<h2 class="hasAnchor">
<a href="#simulated-data-with-fixed-dispersion-and-correlation" class="anchor"></a>Simulated data with fixed dispersion and correlation</h2>
<p style="text-align: justify;">
Inicialmente simulamos variáveis explicativas com distribuição uniforme padrão para as equações de seleção e regressão. Fixamos valores de alguns parâmetros e utilizamos a função <span class="math inline">\({\it mvtnorm()}\)</span> do pacote mvtnorm de <span class="citation">Genz et al. (2019)</span> para simular variáveis <span class="math inline">\(y_{1}\)</span> e <span class="math inline">\(y_{2}\)</span> bivariadas com distribuição normal. A variável <span class="math inline">\(y_{1}\)</span> foi utilizada como resposta de interesse e <span class="math inline">\(y_{2}\)</span> como equação de seleção de tal forma que observamos <span class="math inline">\(yo=y_{1}*1(y_{2}&gt;0).\)</span> Abaixo segue os resultados da simulação.
</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://mvtnorm.R-forge.R-project.org">"mvtnorm"</a></span><span class="op">)</span> <span class="co">#Pacote para geração dos dados</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> 
<span class="co">#Parâmetros utilizados:</span>
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">2.9</span>
<span class="va">rho</span>   <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.5</span>
<span class="va">n</span>     <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">gamma0</span><span class="op">&lt;-</span> <span class="fl">2.2</span>
<span class="va">gamma1</span><span class="op">&lt;-</span> <span class="op">-</span><span class="fl">3</span>
<span class="va">beta0</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span>
<span class="va">beta1</span> <span class="op">&lt;-</span> <span class="fl">2.7</span>
<span class="co">#Covariáveis</span>
<span class="va">xs</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">xo</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="co">#Vetor de parâmetros</span>
<span class="va">b</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">beta0</span>,<span class="va">beta1</span><span class="op">)</span>
<span class="va">g</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">gamma0</span>,<span class="va">gamma1</span><span class="op">)</span>
<span class="va">mu1</span>   <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">xo</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">b</span><span class="op">)</span><span class="op">)</span>
<span class="va">mu2</span>   <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">xs</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">g</span><span class="op">)</span><span class="op">)</span>
<span class="co">#Simulação das variáveis bivariadas com distribuição normal</span>
<span class="va">eps</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="va">n</span>,<span class="fl">2</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">eps</span><span class="op">[</span><span class="va">k</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html">rmvnorm</a></span><span class="op">(</span><span class="fl">1</span>,
                            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">mu1</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>, <span class="va">mu2</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span>,
                            <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sigma</span>, <span class="va">rho</span><span class="op">*</span><span class="va">sigma</span>, <span class="va">rho</span><span class="op">*</span><span class="va">sigma</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#eps &lt;- rmvnorm(1000, c(0,0), matrix(c(sigma, rho*sigma, rho*sigma, 1), 2, 2))</span>
<span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">eps</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">eps</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span>
<span class="co">#Variável de seleção</span>
<span class="va">ys</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">*</span><span class="va">y2</span>
<span class="co">#Variável de interesse primário</span>
<span class="va">yo</span><span class="op">&lt;-</span><span class="va">y1</span><span class="op">*</span><span class="va">ys</span></code></pre></div>
<p style="text-align: justify;">
Com os dados acima, obtemos um total de 30 observações censuradas. Ou seja, cerca de <span class="math inline">\(30\%\)</span> dos dados. É importante observar que as covariáveis são independentes e portanto a restrição de exclusão é garantida. Abaixo comparamos os resultados obtidos com o ajuste da função <span class="math inline">\({\it HeckmanCL()}\)</span> do nosso pacote com a função <span class="math inline">\({\it selection()}\)</span> do pacote sampleSelection. Observamos, como esperado, os mesmos resultados. Apresentamos na <a href="#fig1">Figura 1</a> o diagrama de dispersão dos dados, círculos negros são resultados observados e círculos vazios representam os dados não observados. A linha sólida representa o ajuste do modelo linear aos dados completos, ou seja, essa é a reta que melhor estima a variável de interesse. A reta tracejada, cor vermelha, representa o modelo de Heckman e a reta tracejada na cor azul representa o modelo linear simples ajustado aos dados observados. É possível inferir que na presença de dados censurados, o modelo de Heckman apresenta estimativas mais realistas do que o modelo linear simples ajustado somente aos dados observados.
</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ssmodels</span><span class="op">)</span>
<span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmanCL.html">HeckmanCL</a></span><span class="op">(</span><span class="va">ys</span><span class="op">~</span><span class="va">xs</span>,<span class="va">yo</span><span class="op">~</span><span class="va">xo</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## --------------------------------------------------------------
##           Classic Heckman Model (Package: ssmodels)           
## --------------------------------------------------------------
## --------------------------------------------------------------
## Maximum Likelihood estimation 
## optim function with method BFGS-iterations numbers: 12 
## Log-Likelihood: -169.1171 
## AIC: 350.2342 BIC: 365.8652 
## Number of observations: ( 30 censored and 70 observed ) 
## 6 free parameters ( df= 94 ) 
## --------------------------------------------------------------
## Probit selection equation:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.4221     0.4265   5.679 1.51e-07 ***
## xs           -3.3010     0.6364  -5.187 1.23e-06 ***
## --------------------------------------------------------------
## Outcome equation:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -1.6114     0.4051  -3.977 0.000137 ***
## xo            3.0975     0.6775   4.572 1.47e-05 ***
## --------------------------------------------------------------
## Error terms:
##       Estimate Std. Error t value Pr(&gt;|t|)    
## sigma   1.5441     0.1508   10.24  &lt; 2e-16 ***
## rho    -0.6354     0.1775   -3.58 0.000546 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://www.sampleSelection.org">"sampleSelection"</a></span><span class="op">)</span>
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sampleSelection/man/selection.html">selection</a></span><span class="op">(</span><span class="va">ys</span><span class="op">~</span><span class="va">xs</span>, <span class="va">yo</span> <span class="op">~</span><span class="va">xo</span>, method <span class="op">=</span> <span class="st">"ml"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code></pre></div>
<pre><code>## --------------------------------------------
## Tobit 2 model (sample selection model)
## Maximum Likelihood estimation
## Newton-Raphson maximisation, 7 iterations
## Return code 1: gradient close to zero
## Log-Likelihood: -169.1171 
## 100 observations (30 censored and 70 observed)
## 6 free parameters (df = 94)
## Probit selection equation:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.4220     0.4265   5.679 1.51e-07 ***
## xs           -3.3009     0.6364  -5.186 1.23e-06 ***
## Outcome equation:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -1.6114     0.4051  -3.977 0.000137 ***
## xo            3.0975     0.6775   4.572 1.47e-05 ***
##    Error terms:
##       Estimate Std. Error t value Pr(&gt;|t|)    
## sigma   1.5441     0.1508   10.24  &lt; 2e-16 ***
## rho    -0.6354     0.1775   -3.58 0.000546 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------</code></pre>
<p><a name="fig1"></a></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.9</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="va">pch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">16</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">xo</span>, <span class="va">y1</span>, pch<span class="op">=</span><span class="va">pch</span><span class="op">[</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ys</span><span class="op">]</span>, cex<span class="op">=</span><span class="fl">0.5</span>, lwd<span class="op">=</span><span class="fl">0.5</span>, main <span class="op">=</span> <span class="st">"Figura 1: Ajuste dos modelos de Heckman Clássico e modelo linear \n simples a dados simulados com censura."</span><span class="op">)</span>
<span class="co"># True dependence</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="va">beta0</span>, b<span class="op">=</span><span class="va">beta1</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="co"># Heckman's model</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"red"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="co"># linear model</span>
<span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">yo</span> <span class="op">~</span> <span class="va">xo</span>, subset<span class="op">=</span><span class="va">ys</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="va">cf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, b<span class="op">=</span><span class="va">cf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lty<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"blue"</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/fig1-1.png" width="691.2" style="display: block; margin: auto;"></p>
</div>
<div id="data-with-variable-dispersion-and-correlation" class="section level2">
<h2 class="hasAnchor">
<a href="#data-with-variable-dispersion-and-correlation" class="anchor"></a>Data with variable dispersion and correlation</h2>
<p style="text-align: justify;">
Simulamos dados normais bivariados com dispersão e correlação variáveis. Nesse caso, comparamos o modelo de Heckman generalizado contra o modelo de Heckman clássico e o modelo linear simples. Observamos que o modelo de Heckman clássico apresentou estimativas dos parâmetros da equação principal semelhantes as estimativas do modelo linear simples, já nosso modelo, apresentou resultados próximos aos valores verdadeiros como podemos observar na <a href="#fig2">Figura 2</a>.
</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://mvtnorm.R-forge.R-project.org">"mvtnorm"</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>
<span class="va">gamma0</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">gamma1</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span>
<span class="va">beta0</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span>
<span class="va">beta1</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">lambda0</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>
<span class="va">lambda1</span><span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">kappa0</span> <span class="op">&lt;-</span> <span class="fl">0.3</span>
<span class="va">kappa1</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.5</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">lambda0</span>,<span class="va">lambda1</span><span class="op">)</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">beta0</span>,<span class="va">beta1</span><span class="op">)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">gamma0</span>,<span class="va">gamma1</span><span class="op">)</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">kappa0</span>,<span class="va">kappa1</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">xo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">mu1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">xo</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">b</span><span class="op">)</span><span class="op">)</span>
<span class="va">mu2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">xs</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">g</span><span class="op">)</span><span class="op">)</span>
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">xo</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">a</span><span class="op">)</span><span class="op">)</span>
<span class="va">rho</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Hyperbolic.html">tanh</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">xo</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span>
<span class="va">eps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="va">n</span>,<span class="fl">2</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">eps</span><span class="op">[</span><span class="va">k</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html">rmvnorm</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">mu1</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>,<span class="va">mu2</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">(</span><span class="va">sigma</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,<span class="va">rho</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">*</span><span class="va">sigma</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>,<span class="va">rho</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">*</span><span class="va">sigma</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">eps</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">eps</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span>
<span class="va">ys</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">*</span><span class="va">y2</span>
<span class="va">yo</span><span class="op">&lt;-</span><span class="va">y1</span><span class="op">*</span><span class="va">ys</span></code></pre></div>
<p>No caso dos dados simulados acima, observamos 65 valores censurados.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmanCL.html">HeckmanCL</a></span><span class="op">(</span><span class="va">ys</span><span class="op">~</span><span class="fl">1</span><span class="op">+</span><span class="va">xs</span>, <span class="va">yo</span> <span class="op">~</span><span class="fl">1</span><span class="op">+</span><span class="va">xo</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## --------------------------------------------------------------
##           Classic Heckman Model (Package: ssmodels)           
## --------------------------------------------------------------
## --------------------------------------------------------------
## Maximum Likelihood estimation 
## optim function with method BFGS-iterations numbers: 10 
## Log-Likelihood: -330.9163 
## AIC: 673.8326 BIC: 693.6225 
## Number of observations: ( 65 censored and 135 observed ) 
## 6 free parameters ( df= 194 ) 
## --------------------------------------------------------------
## Probit selection equation:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.5728     0.1078   5.313 2.95e-07 ***
## xs           -0.9607     0.1375  -6.989 4.34e-11 ***
## --------------------------------------------------------------
## Outcome equation:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -1.9661     0.1666  -11.80   &lt;2e-16 ***
## xo            1.7702     0.1178   15.03   &lt;2e-16 ***
## --------------------------------------------------------------
## Error terms:
##       Estimate Std. Error t value Pr(&gt;|t|)    
## sigma  1.40942    0.08715  16.172   &lt;2e-16 ***
## rho   -0.14490    0.20550  -0.705    0.482    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmanGe.html">HeckmanGe</a></span><span class="op">(</span><span class="va">ys</span><span class="op">~</span><span class="va">xs</span>, <span class="va">yo</span> <span class="op">~</span><span class="va">xo</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">xo</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">xo</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## --------------------------------------------------------------
##        Generalized Heckman Model (Package: ssmodels)          
## --------------------------------------------------------------
## --------------------------------------------------------------
## Maximum Likelihood estimation 
## optim function with method BFGS-iterations numbers: 16 
## Log-Likelihood: -289.7669 
## AIC: 595.5338 BIC: 621.9204 
## Number of observations: ( 65 censored and 135 observed ) 
## 8 free parameters ( df= 192 ) 
## --------------------------------------------------------------
## Probit selection equation:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.5650     0.1058   5.340 2.61e-07 ***
## xs           -0.9896     0.1359  -7.282 8.25e-12 ***
## --------------------------------------------------------------
## Outcome equation:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.89174    0.12762  -14.82   &lt;2e-16 ***
## xo           2.03231    0.08173   24.87   &lt;2e-16 ***
## --------------------------------------------------------------
## Dispersion terms:
##            Estimate Std. Error t value Pr(&gt;|t|)    
## interceptS  0.05481    0.06492   0.844      0.4    
## xo          0.55189    0.06230   8.859 5.43e-16 ***
## --------------------------------------------------------------
## Correlation terms:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## interceptC -0.006671   0.210477  -0.032  0.97475   
## xo         -0.635305   0.209722  -3.029  0.00279 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------------------------</code></pre>
<p>Gráfico</p>
<p><a name="fig2"></a></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.9</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="va">pch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">16</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">xo</span>, <span class="va">y1</span>, pch<span class="op">=</span><span class="va">pch</span><span class="op">[</span><span class="fl">1</span> <span class="op">+</span> <span class="va">ys</span><span class="op">]</span>, cex<span class="op">=</span><span class="fl">0.5</span>, lwd<span class="op">=</span><span class="fl">0.3</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>,<span class="fl">8</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Figura 2: Ajuste dos modelos de Heckman Generalizados e Clássico \n e modelo linear simples a dados simulados com censura."</span><span class="op">)</span>
<span class="co"># True dependence</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="va">beta0</span>, b<span class="op">=</span><span class="va">beta1</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="co"># Heckman's model</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m0</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"blue"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="co"># linear model</span>
<span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">xo</span>, subset<span class="op">=</span><span class="va">ys</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="va">m2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, b<span class="op">=</span><span class="va">m2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lty<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"green"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="co"># Heckman Generalized</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, lty<span class="op">=</span><span class="fl">5</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/fig2-1.png" width="691.2" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="comparison-of-parametric-sample-selection-models" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-of-parametric-sample-selection-models" class="anchor"></a>Comparison of Parametric Sample Selection Models</h1>
<p style="text-align: justify;">
<span class="citation">Heckman (1976)</span> introduziu o modelo de seleção amostral clássico. A maior crítica em relação ao modelo foi a sensibilidade da estimação dos parâmetros à suposição de normailidade dos erros, frequentemente violada na prática. Devido a isso, <span class="citation">Heckman (1979)</span> introduziu um método mais prático e eficiente para estimação de parâmetros, tal método ficou conhecido como método de dois passos e é utilizado principalmente como ferramenta para encontrar valores iniciais para algoritmos iterativos de estimação por máxima verossimilhança. Mesmo após os dois trabalhos de Heckman, houve ainda muita discussão em relação a distribuição bivariada dos termos de erro das equações de seleção e regressão. Diversos trabalhos sobre problemas de multicolinearidade, comparações do método de dois passos com outros procedimentos, problema de heterocedásticidade e outros foram publicados. Somente no trabalho de <span class="citation">Marchenko and Genton (2012)</span>, 36 (trinta e seis) anos depois, conseguiram substituir a distribuição normal pela distribuição t de Student, que é uma distribuição mais robusta, no sentido de se ajustar melhor a distribuição de dados discrepantes (distantes da média). Após mais mais quatro anos, no trabalho de <span class="citation">Ogundimu and Hutton (2016)</span>, foi introduzido o modelo Heckman-Skew, em que a distribuição normal foi substítuida pela distribuição Skew-Normal e o modelo foi sugerido para ser ajustado a dados assimétricos.
</p>
<p style="text-align: justify;">
O maior problema dos dois modelos, skew e t de Student, é a necessidade da estimação dos parâmetros de assimetria e de graus de liberdade, respectivamente. Ambos, reconhecidamente difíceis de serem estimados. Além disso, mesmo o modelo Skew sendo para dados assimétricos, em seu ajuste, a distribuição da variável de interesse não pode ser altamente assimétrica, quando este é o caso, devemos transformar a variável de interesse na tentiva de torna-la mais simétrica, o que afeta a interpretação dos parâmetros. Devido a isso, em 2018, introduzimos o modelo Heckman-BS, em que utilizamos a distribuição Birnbaum-Saunders em substituição a distribuição normal. Nosso modelo apresenta várias vantagens quando comparado aos modelos existentes na literatura, além de ser parcimonioso, pois possui a mesma quantidade de parâmetros do modelo clássico de Heckman, ele também é para dados assimétricos e positivos. E a maioria dos bancos de dados em que o modelo de Heckman é ajustado satisfaz tais premissas. Além disso, não necessita da transformação da variável de interesse para seu ajuste, em nenhum caso, o que torna a interpretação dos parâmetros mais realista e direta. Vamos comparar daqui em diante o ajuste e a estimação dos parâmetros dos modelos clássico de Heckman e os modelos Heckman-Skew, Heckman-t e Heckman-BS. Vamos simular dados assimétricos e positivos e também ajustar tais modelos a banco de dados com problemas de viés de seleção existentes na literatura.
</p>
<div id="simulation-of-asymmetric-and-positive-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-of-asymmetric-and-positive-data" class="anchor"></a>Simulation of asymmetric and positive data</h2>
<p style="text-align: justify;">
Quando desejamos ajustar um modelo de regressão a uma variável resposta que não é observada em sua totalidade e desconfiamos que a não observação é devido a alguma outra variável não observada, podemos estar diante de um problema de viés de seleção. Neste caso, o ajuste do modelo de Heckman é a principal indicação. No entanto, tais dados, podem ainda ser assimétricos, ou possuir muitas observações distantes da média, ou ainda apresentar heterocedasticidade, o que torna suspeita qualquer estimação obtida com a modelagem clássica de Heckman. Veremos adiante a comparação dos resultados obtidos com o ajuste dos modelos Clássico, Heckman-Skew, Heckman-t e Heckman-BS a dados simulados positivos e assimétricos.
</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>
<span class="va">n</span><span class="op">=</span><span class="fl">200</span> <span class="co">#Tamanho das amostras</span>
<span class="co">#Valores iniciais dos parametros usados para gerar as vari?veis. </span>
<span class="co">#Ou seja, Valor verdadeiro dos parametros</span>
<span class="co">#Para manter 30% de censura, manter os seguintes parametros:</span>
<span class="va">gamma0</span> <span class="op">&lt;-</span> <span class="fl">1.6</span>
<span class="va">gamma1</span> <span class="op">&lt;-</span> <span class="fl">0.8</span>
<span class="va">gamma2</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>
<span class="va">gamma3</span> <span class="op">&lt;-</span> <span class="fl">0.7</span>
<span class="va">beta0</span>  <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">beta1</span>  <span class="op">&lt;-</span> <span class="fl">0.7</span>
<span class="va">beta2</span>  <span class="op">&lt;-</span> <span class="fl">1.1</span>
<span class="va">phi1</span>   <span class="op">&lt;-</span> <span class="fl">1.2</span>
<span class="va">phi2</span>   <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">rho</span>    <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.5</span>
<span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">nu</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="co">#Matriz de covari?veis para gerar mu1</span>
<span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">n</span><span class="op">)</span>
<span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">X3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">X4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">XO</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">X2</span>,<span class="va">X3</span><span class="op">)</span>
<span class="co">#Matriz de covari?veis para gerar mu2, sem restri??o de exclus?o</span>
<span class="va">XS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">X2</span>,<span class="va">X3</span>,<span class="va">X4</span><span class="op">)</span>
<span class="co">#Vetor de valores verdadeiros dos parametros</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">beta0</span>,<span class="va">beta1</span>,<span class="va">beta2</span><span class="op">)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">gamma0</span>,<span class="va">gamma1</span>,<span class="va">gamma2</span>,<span class="va">gamma3</span><span class="op">)</span>
<span class="co">#Vetor de medias 1</span>
<span class="va">mu1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">XO</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">b</span><span class="op">)</span><span class="op">)</span>
<span class="co">#Vetor de medias 2</span>
<span class="va">mu2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">XS</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">g</span><span class="op">)</span><span class="op">)</span>

<span class="va">u1</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">u2</span>  <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">z1</span>  <span class="op">&lt;-</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">rho</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">rho</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">u1</span><span class="op">+</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">rho</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">rho</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">u2</span>
<span class="va">z2</span>  <span class="op">&lt;-</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">rho</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">rho</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">u1</span><span class="op">+</span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">rho</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">rho</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">u2</span>
<span class="co">#################################################################</span>
<span class="co">#Vari?veis (T1,T2)~BSB(mu1,phi1,mu2,1,rho)</span>
<span class="co">##########################################################</span>
<span class="va">T1</span><span class="op">&lt;-</span><span class="op">(</span><span class="va">mu1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">phi1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">/</span><span class="va">phi1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">z1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">/</span><span class="va">phi1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">z1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
<span class="va">T2</span><span class="op">&lt;-</span><span class="op">(</span><span class="va">mu2</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">phi2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">/</span><span class="va">phi2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">z2</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">/</span><span class="va">phi2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">z2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
<span class="co">################################################################</span>
<span class="co">#Vari?vel indicadora</span>
<span class="co">######################################</span>
<span class="va">YS</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">T2</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span>
<span class="co">#######################################################</span>
<span class="co">#Variavel de interesse cuja densidade eh obtida apartir da distribuicao</span>
<span class="co">#Birnbaum Saunders bivariada, observe que esta eh uma variavel com censura</span>
<span class="co">#e de acordo com a minha especificacao dos parametros a censura eh de</span>
<span class="co">#aproximadamente 30%.</span>
<span class="co">############################################################</span>
<span class="va">YO</span><span class="op">&lt;-</span><span class="va">T1</span><span class="op">*</span><span class="va">YS</span></code></pre></div>
<p>Observamos 66 valores censurados, ou seja, cerca de 33 porcento dos dados.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Data frame com os dados simulados</span>
<span class="va">dt1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">YO</span>,<span class="va">YS</span>,<span class="va">XO</span>,<span class="va">XS</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dt1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"YO"</span>,<span class="st">"YS"</span>,<span class="st">"XO1"</span>,<span class="st">"XO2"</span>,<span class="st">"XS1"</span>,<span class="st">"XS2"</span>,<span class="st">"XS3"</span><span class="op">)</span>
<span class="va">selectionEq</span> <span class="op">&lt;-</span> <span class="va">YS</span><span class="op">~</span><span class="va">XS1</span><span class="op">+</span><span class="va">XS2</span><span class="op">+</span><span class="va">XS3</span>
<span class="va">outcomeEq</span> <span class="op">&lt;-</span> <span class="va">YO</span><span class="op">~</span><span class="va">XO1</span><span class="op">+</span><span class="va">XO2</span>
<span class="va">mBS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmanBS.html">HeckmanBS</a></span><span class="op">(</span><span class="va">selectionEq</span>,<span class="va">outcomeEq</span>, data<span class="op">=</span><span class="va">dt1</span><span class="op">)</span>
<span class="co">#Transformacao de y para ajuste dos demais modelos </span>
<span class="va">l_YO</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">YS</span><span class="op">==</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">YO</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span>
<span class="co">#Variavel resposta para ajuste dos demais modelos</span>
<span class="va">dt2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">l_YO</span>,<span class="va">YS</span>,<span class="va">XO</span>,<span class="va">XS</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dt2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l_YO"</span>,<span class="st">"YS"</span>,<span class="st">"XO1"</span>,<span class="st">"XO2"</span>,<span class="st">"XS1"</span>,<span class="st">"XS2"</span>,<span class="st">"XS3"</span><span class="op">)</span>
<span class="va">selection</span> <span class="op">&lt;-</span> <span class="va">YS</span><span class="op">~</span><span class="va">XS1</span><span class="op">+</span><span class="va">XS2</span><span class="op">+</span><span class="va">XS3</span>
<span class="va">outcome</span> <span class="op">&lt;-</span> <span class="va">l_YO</span><span class="op">~</span><span class="va">XO1</span><span class="op">+</span><span class="va">XO2</span>
<span class="va">mCL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmanCL.html">HeckmanCL</a></span><span class="op">(</span><span class="va">selection</span>, <span class="va">outcome</span>, data<span class="op">=</span><span class="va">dt2</span><span class="op">)</span>
<span class="va">mtS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmantS.html">HeckmantS</a></span><span class="op">(</span><span class="va">selection</span>, <span class="va">outcome</span>, data<span class="op">=</span><span class="va">dt2</span>, <span class="va">nu</span><span class="op">)</span>
<span class="va">mSK</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmanSK.html">HeckmanSK</a></span><span class="op">(</span><span class="va">selection</span>, <span class="va">outcome</span>, data<span class="op">=</span><span class="va">dt2</span>, <span class="va">lambda</span><span class="op">)</span></code></pre></div>
<p>Grafico</p>
<p><a name="fig3"></a></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.9</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"gridExtra"</span><span class="op">)</span>
<span class="va">barfill</span> <span class="op">&lt;-</span> <span class="st">"grey"</span>
<span class="va">barlines</span> <span class="op">&lt;-</span> <span class="st">"black"</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dt1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">YO</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, bins<span class="op">=</span><span class="fl">10</span>, colour <span class="op">=</span> <span class="va">barlines</span>, fill <span class="op">=</span> <span class="va">barfill</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"(a) Values of the variable of interest"</span><span class="op">)</span>
  <span class="co">#                    breaks = seq(0, 125, 25),</span>
  <span class="co">#                    limits=c(0, 125))+</span>
  <span class="co"># scale_y_continuous(name = "Count",</span>
  <span class="co">#                    breaks = seq(0, 0.01, 0.005),</span>
  <span class="co">#                    limits=c(0,  0.01))</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dt2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">l_YO</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, bins<span class="op">=</span><span class="fl">10</span>, colour <span class="op">=</span> <span class="va">barlines</span>, fill <span class="op">=</span> <span class="va">barfill</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"(b) Log of values of variable of interest"</span>, limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>
  <span class="co">#                    breaks = seq(-5, 5, 1),</span>
  <span class="co">#                    limits=c(-5, 5))+</span>
  <span class="co"># scale_y_continuous(name = "Count",</span>
  <span class="co">#                    breaks = seq(0, 1, 0.2),</span>
  <span class="co">#                    limits=c(0, 1))</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<img src="vignette_files/figure-html/fig3-1.png" width="691.2" style="display: block; margin: auto;"><p style="text-align: justify;">
O modelo Heckman-BS é ajustado aos dados simulados sem nenhuma transformação, os demais modelos são ajustados ao logaritmo dos dados, os resultados da estimação seguem abaixo. Observem que o modelo Heckman-BS apresenta os melhores resultados, além disso, o intercepto da equação de interesse primário é altamente viesado quando estimado pelos demais modelos. <span class="citation">Marchenko and Genton (2012)</span> justifica a importância deste parâmetro na interpretação prática do ajuste do modelo, principalmente em aplicações Econômicas.
</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"$\\gamma_{0}$"</span>, <span class="st">"$\\gamma_{1}$"</span>, <span class="st">"$\\gamma_{2}$"</span>, <span class="st">"$\\gamma_{3}$"</span>, <span class="st">"$\\beta_{0}$"</span>, <span class="st">"$\\beta_{1}$"</span>, <span class="st">"$\\beta_{2}$"</span>, <span class="st">"$\\phi$"</span>, <span class="st">"$\\rho$"</span>, <span class="st">"$\\lambda$"</span>, <span class="st">"$\\nu$"</span><span class="op">)</span>
<span class="va">truevalue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gamma0</span>, <span class="va">gamma1</span>, <span class="va">gamma2</span>, <span class="va">gamma3</span>, <span class="va">beta0</span>, <span class="va">beta1</span>, <span class="va">beta2</span>, <span class="va">phi1</span>, <span class="va">rho</span>, <span class="va">lambda</span>, <span class="va">nu</span><span class="op">)</span>
<span class="va">HBS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mBS</span><span class="op">$</span><span class="va">coefficients</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">HCL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mCL</span><span class="op">$</span><span class="va">coefficients</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">HSK</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mSK</span><span class="op">$</span><span class="va">coefficients</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">HtS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mtS</span><span class="op">$</span><span class="va">coefficients</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">Results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Parameters"</span><span class="op">=</span> <span class="va">Parameters</span>,
                      <span class="st">"truevalue"</span> <span class="op">=</span> <span class="va">truevalue</span>,
                      <span class="st">"HeckmanBS"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">HBS</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span><span class="op">)</span>, 
                      <span class="st">"HeckmanCL"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">HCL</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span><span class="op">)</span>,
                      <span class="st">"HeckmantS"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">HtS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, <span class="st">"NA"</span>, <span class="va">HtS</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>,
                      <span class="st">"HeckmanSK"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">HSK</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, <span class="va">HSK</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>, <span class="st">"NA"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">kable</span><span class="op">(</span><span class="va">Results</span>, format <span class="op">=</span> <span class="st">"html"</span>, align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:center;">
Parameters
</th>
<th style="text-align:center;">
truevalue
</th>
<th style="text-align:center;">
HeckmanBS
</th>
<th style="text-align:center;">
HeckmanCL
</th>
<th style="text-align:center;">
HeckmantS
</th>
<th style="text-align:center;">
HeckmanSK
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\gamma_{0}\)</span>
</td>
<td style="text-align:center;">
1.6
</td>
<td style="text-align:center;">
1.54
</td>
<td style="text-align:center;">
0.659
</td>
<td style="text-align:center;">
0.662
</td>
<td style="text-align:center;">
0.685
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\gamma_{1}\)</span>
</td>
<td style="text-align:center;">
0.8
</td>
<td style="text-align:center;">
0.816
</td>
<td style="text-align:center;">
0.643
</td>
<td style="text-align:center;">
0.646
</td>
<td style="text-align:center;">
0.642
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\gamma_{2}\)</span>
</td>
<td style="text-align:center;">
0.2
</td>
<td style="text-align:center;">
0.018
</td>
<td style="text-align:center;">
0.024
</td>
<td style="text-align:center;">
0.025
</td>
<td style="text-align:center;">
0.024
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\gamma_{3}\)</span>
</td>
<td style="text-align:center;">
0.7
</td>
<td style="text-align:center;">
0.747
</td>
<td style="text-align:center;">
0.593
</td>
<td style="text-align:center;">
0.596
</td>
<td style="text-align:center;">
0.593
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\beta_{0}\)</span>
</td>
<td style="text-align:center;">
1.0
</td>
<td style="text-align:center;">
0.857
</td>
<td style="text-align:center;">
0.319
</td>
<td style="text-align:center;">
0.32
</td>
<td style="text-align:center;">
0.258
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\beta_{1}\)</span>
</td>
<td style="text-align:center;">
0.7
</td>
<td style="text-align:center;">
0.936
</td>
<td style="text-align:center;">
0.972
</td>
<td style="text-align:center;">
0.974
</td>
<td style="text-align:center;">
0.972
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\beta_{2}\)</span>
</td>
<td style="text-align:center;">
1.1
</td>
<td style="text-align:center;">
1.136
</td>
<td style="text-align:center;">
1.183
</td>
<td style="text-align:center;">
1.184
</td>
<td style="text-align:center;">
1.183
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\phi\)</span>
</td>
<td style="text-align:center;">
1.2
</td>
<td style="text-align:center;">
1.344
</td>
<td style="text-align:center;">
1.086
</td>
<td style="text-align:center;">
1.081
</td>
<td style="text-align:center;">
1.088
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\rho\)</span>
</td>
<td style="text-align:center;">
-0.5
</td>
<td style="text-align:center;">
-0.481
</td>
<td style="text-align:center;">
-0.47
</td>
<td style="text-align:center;">
-0.47
</td>
<td style="text-align:center;">
-0.472
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\lambda\)</span>
</td>
<td style="text-align:center;">
1.0
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
0.072
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(\nu\)</span>
</td>
<td style="text-align:center;">
10.0
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
137.677
</td>
<td style="text-align:center;">
NA
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#kable_styling(, bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = TRUE)</span></code></pre></div>
<p style="text-align: justify;">
É importante ainda observar que os valores estimados do parâmetro de graus de liberdade do modelo Heckman-t e do parâmetro estimado pelo modelo Heckman-Skew indicam que os dados transformados possuem distribuição normal e, provavelmente por isso, apresentam resultados tão próximos do modelo clássico de Heckman.
</p>
</div>
</div>
<div id="reals-database" class="section level1">
<h1 class="hasAnchor">
<a href="#reals-database" class="anchor"></a>Reals Database</h1>
<div id="meps-2001" class="section level2">
<h2 class="hasAnchor">
<a href="#meps-2001" class="anchor"></a>MEPS 2001</h2>
<p style="text-align: justify;">
The MEPS is a set of large-scale surveys of families, individuals and their medical providers (doctors, hospitals, pharmacies, etc.) in the United States. It has data on the health services Americans use, how often they use them, the cost of these services and how they are paid, as well as data on the cost and reach of health insurance available to American workers. The sample is restricted to persons aged between 21 and 64 years and contains a variable response with 3328 observations of outpatient costs, of which 526 (15.8%) correspond to unobserved expenditure values and identified as zero expenditure for adjustment of the models. It also includes the following explanatory variables:
</p>
<ul>
<li>educ: education status</li>
<li>age: Age</li>
<li>income: income</li>
<li>female: gender</li>
<li>vgood: a numeric vector</li>
<li>good: a numeric vector</li>
<li>hospexp: a numeric vector</li>
<li>totchr: number of chronic diseases</li>
<li>ffs: a numeric vector</li>
<li>dhospexp: a numeric vector</li>
<li>age2: a numeric vector</li>
<li>agefem: a numeric vector</li>
<li>fairpoor: a numeric vector</li>
<li>year01: a numeric vector</li>
<li>instype: a numeric vector</li>
<li>ambexp: a numeric vector</li>
<li>lambexp: log ambulatory expenditures</li>
<li>blhisp: ethnicity</li>
<li>instype_s1: a numeric vector</li>
<li>dambexp: dummy variable, ambulatory expenditures</li>
<li>lnambx: a numeric vector</li>
<li>ins: insurance status
<p style="text-align: justify;">
These data were also used by <span class="citation">Colin and Trivedi (2009)</span>, <span class="citation">Marchenko and Genton (2012)</span> and <span class="citation">Zhelonkin, Genton, and Ronchetti (2016)</span> to fit the classical Heckman and Heckman-t models and the robust version of the two-step method, respectively. We use the variable of interest <span class="math inline">\(Y_{1}^{*}={\rm ambexp}\)</span>, which represents expenditure on medical services, on the logarithmic scale, since it is highly asymmetric, see <a href="#fig4">Figura 4</a>. The variable <span class="math inline">\(Y_{2}^{*}={\rm dambexp},\)</span> representing the willingness to spend, is not observed. We observe <span class="math inline">\(U=1\{Y_{2}^{*}&gt;0\},\)</span> which represents the decision to spend on medical care.
</p>
<a name="fig4"></a>
</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ssmodels</span><span class="op">)</span>
<span class="co">#Leitura do dados MEPS2001</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">MEPS2001</span><span class="op">)</span>
<span class="co">#tornando visiveis as colunas do data-frame</span>
<span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span><span class="op">(</span><span class="va">MEPS2001</span><span class="op">)</span>
<span class="va">barfill</span> <span class="op">&lt;-</span> <span class="st">"grey"</span>
<span class="va">barlines</span> <span class="op">&lt;-</span> <span class="st">"black"</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">MEPS2001</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">ambexp</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">barlines</span>, fill <span class="op">=</span> <span class="va">barfill</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"(a) Expenditures Medical"</span>,
                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15000</span>, <span class="fl">2500</span><span class="op">)</span>,
                     limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15000</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Count"</span>,
                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">800</span>, <span class="fl">100</span><span class="op">)</span>,
                     limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">800</span><span class="op">)</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">MEPS2001</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">lambexp</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">barlines</span>, fill <span class="op">=</span> <span class="va">barfill</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"(b) Log of Expenditures Medical"</span>,
                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">11</span>, <span class="fl">1</span><span class="op">)</span>,
                     limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">11</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Count"</span>,
                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">300</span>, <span class="fl">100</span><span class="op">)</span>,
                     limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">300</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<img src="vignette_files/figure-html/fig4-1.png" width="691.2" style="display: block; margin: auto;"><p style="text-align: justify;">
According <span class="citation">Marchenko and Genton (2012)</span> and <span class="citation">Zhelonkin, Genton, and Ronchetti (2016)</span> it is natural to fit a sample selection model to such data, since the willingness to spend <span class="math inline">\((Y_{2}^{*})\)</span> is likely to be related to the expense amount <span class="math inline">\((Y_{1}^{*}).\)</span> However, after fitting the classic Heckman model and using the Wald, likelihood ratio, or gradient tests for <span class="math inline">\(H_{0}:\rho=0\)</span> against <span class="math inline">\(H_{1}:\rho\neq 0,\)</span> the conclusion is that there is not sufficient evidence <span class="math inline">\((p\textrm{-valor}&gt;0.1)\)</span> to reject <span class="math inline">\(H_{0},\)</span> that is, there is no bias of selection. <span class="citation">Colin and Trivedi (2009)</span> suspected this conclusion and <span class="citation">Marchenko and Genton (2012)</span> argued that a more robust model could evidence the selection bias present in the data and rejected the normality hypothesis of the data. However, we understand that the adjustment of the dispersion and/or the correlation can be an alternative to study these data without the need to modify the assumption of normality of the errors, because as our simulations indicate, the estimations of the parameters obtained by the adjustment of the model Heckman can be more severely affected by heteroscedasticity than by incorrect distribution of error terms.
</p>
<p style="text-align: justify;">
No entanto, devido a assimetria dos dados, ajustamos também o modelo Heckman-BS. Thus, we consider the following system of equations for classic and generalized Heckman models, Heckman-t and Heckman-Skew:
</p>
<p><span class="math display">\[\begin{align}
lnambx &amp;= \beta_{1}+ \beta_{2}age + \beta_{3}female + \beta_{4}educ + \beta_{5}blhisp + \beta_{6}totchr + \beta_{7}ins + \epsilon_{1i}, \label{eq_reg_aplic1} \\
dambexp&amp;= \gamma_{1}+\gamma_{2}age + \gamma_{3}female + \gamma_{4}educ + \gamma_{5}blhisp + \gamma_{6}totchr + \gamma_{7}ins + \gamma_{8}income + \epsilon_{2i}, \label{eq_sel_aplic1} 
\end{align}\]</span> where errors are defined for classic Heckman models, Heckman-t and Heckman-Skew according to <span class="math display">\[\begin{align}\label{2:disterro}
\begin{pmatrix}\epsilon_{1i}\\
\epsilon_{2i}
\end{pmatrix} &amp;\overset{ind.}{\sim} \mathcal{N}
\begin{bmatrix}
\begin{pmatrix}
0\\
0
\end{pmatrix}\!\!,&amp;
\begin{pmatrix}
\sigma^{2} &amp; \rho\sigma \\
\sigma\rho &amp; 1
\end{pmatrix}
\end{bmatrix}, i=1,\cdots,n,
\end{align}\]</span> and for generalized Heckman models how <span class="math display">\[\begin{align}\label{2:disterro1}
\begin{pmatrix}\epsilon_{1i}\\
\epsilon_{2i}
\end{pmatrix} &amp;\overset{ind.}{\sim} \mathcal{N}
\begin{bmatrix}
\begin{pmatrix}
0\\
0
\end{pmatrix}\!\!,&amp;
\begin{pmatrix}
\sigma_{i}^{2} &amp; \rho_{i}\sigma_{i} \\
\sigma_{i}\rho_{i} &amp; 1
\end{pmatrix}
\end{bmatrix}, i=1,\cdots,n,
\end{align}\]</span> in such a way that <span class="math display">\[\begin{align*}
\log{(\sigma_{i})} &amp;= \lambda_{1}+\lambda_{2}age + \lambda_{3}female + \lambda_{4}totchr + \lambda_{5}ins\quad \textrm{and}\\ 
\rho_{i}&amp;=\tanh{(\kappa_{0})}, i=1,\cdots, 3328.
\end{align*}\]</span></p>
Para ajuste do modelo Heckman-BS consideramos <span class="math display">\[\begin{align*}
\log\mu_{1i} &amp;= \beta_{1} + \beta_{2}age + \beta_{3}female  + \beta_{4}educ + \beta_{5}blhisp + \beta_{6}totchr + \beta_{7}ins,\\
\log\mu_{2i} &amp;= \gamma_{1}+\gamma_{2}age + \gamma_{3}female + \gamma_{4}educ + \gamma_{5}blhisp + 
\gamma_{6}totchr + \gamma_{7}ins + \gamma_{8}income,\quad i=1,2,\cdots,3328. 
\end{align*}\]</span>
<p style="text-align: justify;">
and <span class="math inline">\((ambexp,dambexp)\)</span> é independentemente distribuido com distribuição Birnbaum-Saunders (BS) Bivariada de parâmetros <span class="math inline">\(\mu_{1}&gt;0, \mu_{2}&gt;0, \phi_{1}=\phi&gt;0, \phi_{2}=1\)</span> e <span class="math inline">\(-1&lt;\rho&lt;1,\)</span> ou seja, <span class="math display">\[(ambexp_{i},dambexp_{i})\stackrel{ind}{\sim}\mbox{ BS}(\mu_{1i},\mu_{2i}, 
\phi,1,\rho), \mu_{1i}&gt;0, \mu_{2i}&gt;0, \phi&gt;0\quad \textrm{and}\quad -1&lt;\rho&lt;1, i=1,\cdots, n\]</span>
</p>
<p style="text-align: justify;">
Observamos valores semelhantes para os parâmetros estimados por todos os modelos, principalmente, os parâmetros da variável de interesse. No entanto, o único modelo que permite uma interpretação direta de tais parâmetros é o modelo Heckman-BS. Podemos, por exemplo, afirmar, baseado no resultado desse modelo, que mantidos os demais parâmetros fixos, a mudança de uma unidade na idade representa o aumento de <span class="math inline">\(24.6\%\)</span> no gasto com despesas ambulatoriais. Para os demais modelos a interpretação é relacionada ao log das despesas ambulatoriais. Vejam os resultados das estimativas dos parâmetros abaixo:
</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">selectEq</span> <span class="op">&lt;-</span> <span class="va">dambexp</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">blhisp</span> <span class="op">+</span> <span class="va">totchr</span> <span class="op">+</span> <span class="va">ins</span> <span class="op">+</span> <span class="va">income</span>
<span class="va">outcomeEq</span> <span class="op">&lt;-</span> <span class="va">lnambx</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">blhisp</span> <span class="op">+</span> <span class="va">totchr</span> <span class="op">+</span> <span class="va">ins</span> 
<span class="va">outcomeS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">age</span>,<span class="va">female</span>,<span class="va">totchr</span>,<span class="va">ins</span><span class="op">)</span>
<span class="va">outcomeC</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">outcomeBS</span> <span class="op">&lt;-</span> <span class="va">ambexp</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">blhisp</span> <span class="op">+</span> <span class="va">totchr</span> <span class="op">+</span> <span class="va">ins</span> 
<span class="va">mCL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmanCL.html">HeckmanCL</a></span><span class="op">(</span><span class="va">selectEq</span>, <span class="va">outcomeEq</span>, data <span class="op">=</span> <span class="va">MEPS2001</span><span class="op">)</span>
<span class="va">mBS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmanBS.html">HeckmanBS</a></span><span class="op">(</span><span class="va">selectEq</span>, <span class="va">outcomeBS</span>, data <span class="op">=</span> <span class="va">MEPS2001</span><span class="op">)</span>
<span class="va">mSK</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmanSK.html">HeckmanSK</a></span><span class="op">(</span><span class="va">selectEq</span>, <span class="va">outcomeEq</span>, data <span class="op">=</span> <span class="va">MEPS2001</span>,lambda <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">mtS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmantS.html">HeckmantS</a></span><span class="op">(</span><span class="va">selectEq</span>, <span class="va">outcomeEq</span>, data <span class="op">=</span> <span class="va">MEPS2001</span>,df<span class="op">=</span><span class="fl">12</span><span class="op">)</span>
<span class="va">mGe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmanGe.html">HeckmanGe</a></span><span class="op">(</span><span class="va">selectEq</span>, <span class="va">outcomeEq</span>,<span class="va">outcomeS</span>, <span class="va">outcomeC</span>, data <span class="op">=</span> <span class="va">MEPS2001</span><span class="op">)</span>
<span class="va">Parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"age"</span>, <span class="st">"female"</span>, <span class="st">"educ"</span>, <span class="st">"blhisp"</span>, <span class="st">"totchr"</span>, <span class="st">"ins"</span>, <span class="st">"income"</span>,
   <span class="st">"Intercept"</span>, <span class="st">"age"</span>, <span class="st">"female"</span>, <span class="st">"educ"</span>, <span class="st">"blhisp"</span>, <span class="st">"totchr"</span>, <span class="st">"ins"</span>, <span class="st">"sigma"</span>, <span class="st">"age"</span>, <span class="st">"female"</span>, <span class="st">"totchr"</span>, <span class="st">"ins"</span>, <span class="st">"rho"</span>, <span class="st">"nu"</span>, <span class="st">"lambda"</span><span class="op">)</span>
<span class="va">HBS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mBS</span><span class="op">$</span><span class="va">coefficients</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">HCL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mCL</span><span class="op">$</span><span class="va">coefficients</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">HSK</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mSK</span><span class="op">$</span><span class="va">coefficients</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">HtS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mtS</span><span class="op">$</span><span class="va">coefficients</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">HGe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mGe</span><span class="op">$</span><span class="va">coefficients</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">Results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Parameters"</span><span class="op">=</span> <span class="va">Parameters</span>,
                      <span class="st">"HeckmanGe"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">HGe</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">21</span><span class="op">]</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span><span class="op">)</span>, 
                      <span class="st">"HeckmanCL"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">HCL</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="va">HCL</span><span class="op">[</span><span class="fl">17</span><span class="op">]</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span><span class="op">)</span>,
                      <span class="st">"HeckmanBS"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">HBS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="va">HBS</span><span class="op">[</span><span class="fl">17</span><span class="op">]</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span><span class="op">)</span>, 
                      <span class="st">"HeckmantS"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">HtS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="va">HtS</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">18</span><span class="op">]</span>, <span class="st">"NA"</span> <span class="op">)</span>,
                      <span class="st">"HeckmanSK"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">HSK</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="va">HSK</span><span class="op">[</span><span class="fl">17</span><span class="op">]</span>, <span class="st">"NA"</span>, <span class="va">HSK</span><span class="op">[</span><span class="fl">18</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="fu">kable</span><span class="op">(</span><span class="va">Results</span>, format <span class="op">=</span> <span class="st">"html"</span>, align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:center;">
Parameters
</th>
<th style="text-align:center;">
HeckmanGe
</th>
<th style="text-align:center;">
HeckmanCL
</th>
<th style="text-align:center;">
HeckmanBS
</th>
<th style="text-align:center;">
HeckmantS
</th>
<th style="text-align:center;">
HeckmanSK
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
Intercept
</td>
<td style="text-align:center;">
-0.59
</td>
<td style="text-align:center;">
-0.676
</td>
<td style="text-align:center;">
0.117
</td>
<td style="text-align:center;">
-0.748
</td>
<td style="text-align:center;">
-0.899
</td>
</tr>
<tr>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
0.094
</td>
<td style="text-align:center;">
0.088
</td>
<td style="text-align:center;">
0.09
</td>
<td style="text-align:center;">
0.099
</td>
<td style="text-align:center;">
0.087
</td>
</tr>
<tr>
<td style="text-align:center;">
female
</td>
<td style="text-align:center;">
0.632
</td>
<td style="text-align:center;">
0.663
</td>
<td style="text-align:center;">
0.722
</td>
<td style="text-align:center;">
0.725
</td>
<td style="text-align:center;">
0.645
</td>
</tr>
<tr>
<td style="text-align:center;">
educ
</td>
<td style="text-align:center;">
0.055
</td>
<td style="text-align:center;">
0.062
</td>
<td style="text-align:center;">
0.068
</td>
<td style="text-align:center;">
0.065
</td>
<td style="text-align:center;">
0.06
</td>
</tr>
<tr>
<td style="text-align:center;">
blhisp
</td>
<td style="text-align:center;">
-0.33
</td>
<td style="text-align:center;">
-0.364
</td>
<td style="text-align:center;">
-0.399
</td>
<td style="text-align:center;">
-0.394
</td>
<td style="text-align:center;">
-0.351
</td>
</tr>
<tr>
<td style="text-align:center;">
totchr
</td>
<td style="text-align:center;">
0.722
</td>
<td style="text-align:center;">
0.797
</td>
<td style="text-align:center;">
0.806
</td>
<td style="text-align:center;">
0.89
</td>
<td style="text-align:center;">
0.775
</td>
</tr>
<tr>
<td style="text-align:center;">
ins
</td>
<td style="text-align:center;">
0.165
</td>
<td style="text-align:center;">
0.17
</td>
<td style="text-align:center;">
0.179
</td>
<td style="text-align:center;">
0.18
</td>
<td style="text-align:center;">
0.17
</td>
</tr>
<tr>
<td style="text-align:center;">
income
</td>
<td style="text-align:center;">
0.002
</td>
<td style="text-align:center;">
0.003
</td>
<td style="text-align:center;">
0.003
</td>
<td style="text-align:center;">
0.003
</td>
<td style="text-align:center;">
0.003
</td>
</tr>
<tr>
<td style="text-align:center;">
Intercept
</td>
<td style="text-align:center;">
5.862
</td>
<td style="text-align:center;">
5.044
</td>
<td style="text-align:center;">
5.779
</td>
<td style="text-align:center;">
5.206
</td>
<td style="text-align:center;">
6.452
</td>
</tr>
<tr>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
0.172
</td>
<td style="text-align:center;">
0.212
</td>
<td style="text-align:center;">
0.246
</td>
<td style="text-align:center;">
0.207
</td>
<td style="text-align:center;">
0.202
</td>
</tr>
<tr>
<td style="text-align:center;">
female
</td>
<td style="text-align:center;">
0.15
</td>
<td style="text-align:center;">
0.348
</td>
<td style="text-align:center;">
0.411
</td>
<td style="text-align:center;">
0.307
</td>
<td style="text-align:center;">
0.287
</td>
</tr>
<tr>
<td style="text-align:center;">
educ
</td>
<td style="text-align:center;">
0.001
</td>
<td style="text-align:center;">
0.019
</td>
<td style="text-align:center;">
-0.007
</td>
<td style="text-align:center;">
0.017
</td>
<td style="text-align:center;">
0.013
</td>
</tr>
<tr>
<td style="text-align:center;">
blhisp
</td>
<td style="text-align:center;">
-0.135
</td>
<td style="text-align:center;">
-0.219
</td>
<td style="text-align:center;">
-0.215
</td>
<td style="text-align:center;">
-0.193
</td>
<td style="text-align:center;">
-0.201
</td>
</tr>
<tr>
<td style="text-align:center;">
totchr
</td>
<td style="text-align:center;">
0.413
</td>
<td style="text-align:center;">
0.54
</td>
<td style="text-align:center;">
0.589
</td>
<td style="text-align:center;">
0.513
</td>
<td style="text-align:center;">
0.492
</td>
</tr>
<tr>
<td style="text-align:center;">
ins
</td>
<td style="text-align:center;">
-0.109
</td>
<td style="text-align:center;">
-0.03
</td>
<td style="text-align:center;">
-0.061
</td>
<td style="text-align:center;">
-0.052
</td>
<td style="text-align:center;">
-0.08
</td>
</tr>
<tr>
<td style="text-align:center;">
sigma
</td>
<td style="text-align:center;">
0.613
</td>
<td style="text-align:center;">
1.271
</td>
<td style="text-align:center;">
0.703
</td>
<td style="text-align:center;">
1.195
</td>
<td style="text-align:center;">
1.736
</td>
</tr>
<tr>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
-0.029
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
female
</td>
<td style="text-align:center;">
-0.13
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
totchr
</td>
<td style="text-align:center;">
-0.119
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
ins
</td>
<td style="text-align:center;">
-0.112
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
rho
</td>
<td style="text-align:center;">
-0.742
</td>
<td style="text-align:center;">
-0.131
</td>
<td style="text-align:center;">
0.273
</td>
<td style="text-align:center;">
-0.322
</td>
<td style="text-align:center;">
-0.339
</td>
</tr>
<tr>
<td style="text-align:center;">
nu
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
12.93
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
lambda
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
-1.662
</td>
</tr>
</tbody>
</table>
<p style="text-align: justify;">
Além disso, há ainda os resultados da significância dos parâmetros. O modelo de Heckman clássico ajustado a tais dados indica ausência de correlação entre as variáveis valor gasto e a decisão de gastar. Conforme <span class="citation">Colin and Trivedi (2009)</span>, tal resultado é suspeito e deve ser melhor analisado.
</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mCL</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## --------------------------------------------------------------
##           Classic Heckman Model (Package: ssmodels)           
## --------------------------------------------------------------
## --------------------------------------------------------------
## Maximum Likelihood estimation 
## optim function with method BFGS-iterations numbers: 22 
## Log-Likelihood: -5836.219 
## AIC: 11706.44 BIC: 11810.31 
## Number of observations: ( 526 censored and 2802 observed ) 
## 17 free parameters ( df= 3311 ) 
## --------------------------------------------------------------
## Probit selection equation:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.676054   0.194029  -3.484  0.00050 ***
## age          0.087936   0.027421   3.207  0.00135 ** 
## female       0.662665   0.060937  10.875  &lt; 2e-16 ***
## educ         0.061948   0.012029   5.150 2.76e-07 ***
## blhisp      -0.363937   0.061874  -5.882 4.46e-09 ***
## totchr       0.796952   0.071130  11.204  &lt; 2e-16 ***
## ins          0.170137   0.062871   2.706  0.00684 ** 
## income       0.002708   0.001316   2.057  0.03973 *  
## --------------------------------------------------------------
## Outcome equation:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  5.04406    0.22813  22.111  &lt; 2e-16 ***
## age          0.21197    0.02301   9.213  &lt; 2e-16 ***
## female       0.34814    0.06011   5.791 7.64e-09 ***
## educ         0.01872    0.01055   1.774 0.076078 .  
## blhisp      -0.21857    0.05967  -3.663 0.000253 ***
## totchr       0.53992    0.03933  13.727  &lt; 2e-16 ***
## ins         -0.02999    0.05109  -0.587 0.557260    
## --------------------------------------------------------------
## Error terms:
##       Estimate Std. Error t value Pr(&gt;|t|)    
## sigma  1.27102    0.01838  69.157   &lt;2e-16 ***
## rho   -0.13060    0.14708  -0.888    0.375    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------------------------</code></pre>
<p style="text-align: justify;">
Já o modelo Heckman generalizado indica que há a presença de heterocedasticidade nos dados e, provavelmente, devido a isso, o modelo clássico de Heckman não é o mais indicado para a modelagem desses dados. Nosso modelo, além de indicar a presença de dispersão variável também indica correlação significativa entre as variáveis valor gasto e a decisão de gastar.
</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mGe</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## --------------------------------------------------------------
##        Generalized Heckman Model (Package: ssmodels)          
## --------------------------------------------------------------
## --------------------------------------------------------------
## Maximum Likelihood estimation 
## optim function with method BFGS-iterations numbers: 68 
## Log-Likelihood: -5804.973 
## AIC: 11651.95 BIC: 11780.26 
## Number of observations: ( 526 censored and 2802 observed ) 
## 21 free parameters ( df= 3307 ) 
## --------------------------------------------------------------
## Probit selection equation:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.589895   0.184517  -3.197 0.001402 ** 
## age          0.093828   0.025969   3.613 0.000307 ***
## female       0.631622   0.058818  10.739  &lt; 2e-16 ***
## educ         0.055187   0.011359   4.858 1.24e-06 ***
## blhisp      -0.329940   0.058875  -5.604 2.27e-08 ***
## totchr       0.722090   0.068092  10.605  &lt; 2e-16 ***
## ins          0.164968   0.060096   2.745 0.006082 ** 
## income       0.002379   0.001208   1.969 0.049045 *  
## --------------------------------------------------------------
## Outcome equation:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  5.8622175  0.1931949  30.344  &lt; 2e-16 ***
## age          0.1721672  0.0236647   7.275  4.3e-13 ***
## female       0.1498488  0.0554233   2.704  0.00689 ** 
## educ         0.0009664  0.0101716   0.095  0.92431    
## blhisp      -0.1346592  0.0577309  -2.333  0.01973 *  
## totchr       0.4131455  0.0285553  14.468  &lt; 2e-16 ***
## ins         -0.1090664  0.0513537  -2.124  0.03376 *  
## --------------------------------------------------------------
## Dispersion terms:
##            Estimate Std. Error t value Pr(&gt;|t|)    
## interceptS  0.61322    0.06434   9.531  &lt; 2e-16 ***
## age        -0.02863    0.01274  -2.247   0.0247 *  
## female     -0.12974    0.02849  -4.554 5.46e-06 ***
## totchr     -0.11853    0.01849  -6.411 1.66e-10 ***
## ins        -0.11224    0.02792  -4.021 5.93e-05 ***
## --------------------------------------------------------------
## Correlation terms:
##     Estimate Std. Error t value Pr(&gt;|t|)    
## rho  -0.6306     0.1024  -6.159  8.2e-10 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------------------------</code></pre>
<p style="text-align: justify;">
Por outro lado, como os dados observados apresentam assimetria, o modelo Heckman-BS pode ser uma boa indicação para ajustar tais dados. Notemos que o modelo Heckman-BS também indica a presença de correlação significativa. Ele apresenta também, como ressaltado anteriormente, a vantagem da parcimônia e da interpretação direta da relação dos parâmetros com a variável resposta de interesse.
</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mBS</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## --------------------------------------------------------------
##    Birnbaum-Saunders Heckman Model (Package: ssmodels)        
## --------------------------------------------------------------
## --------------------------------------------------------------
## Maximum Likelihood estimation 
## optim function with method BFGS-iterations numbers: 26 
## Log-Likelihood: -24470.39 
## AIC: 48974.79 BIC: 49078.66 
## Number of observations: ( 526 censored and 2802 observed ) 
## 17 free parameters ( df= 3311 ) 
## --------------------------------------------------------------
## Probit selection equation:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.117214   0.235265   0.498  0.61836    
## age          0.089502   0.031571   2.835  0.00461 ** 
## female       0.721876   0.069037  10.456  &lt; 2e-16 ***
## educ         0.068319   0.014689   4.651 3.43e-06 ***
## blhisp      -0.399014   0.074350  -5.367 8.57e-08 ***
## totchr       0.805651   0.068209  11.812  &lt; 2e-16 ***
## ins          0.179379   0.073102   2.454  0.01419 *  
## income       0.003425   0.001430   2.395  0.01668 *  
## --------------------------------------------------------------
## Outcome equation:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  5.778691   0.172658  33.469  &lt; 2e-16 ***
## age          0.246156   0.022143  11.117  &lt; 2e-16 ***
## female       0.410538   0.048236   8.511  &lt; 2e-16 ***
## educ        -0.006632   0.009890  -0.671    0.503    
## blhisp      -0.215212   0.053172  -4.047  5.3e-05 ***
## totchr       0.588751   0.034299  17.165  &lt; 2e-16 ***
## ins         -0.061326   0.049610  -1.236    0.216    
## --------------------------------------------------------------
## Error terms:
##       Estimate Std. Error t value Pr(&gt;|t|)    
## sigma  0.70281    0.02072  33.917  &lt; 2e-16 ***
## rho    0.27305    0.05737   4.759 2.02e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------------------------</code></pre>
<p style="text-align: justify;">
O modelo Heckman-t mesmo ajustado ao log das despesas indica a presença de desvio da normalidade, uma vez que, o parâmetro de grau de liberdade é aproximadamente igual a <span class="math inline">\(13\)</span> e é significativo. Tal modelo também observa o parâmetro de correlação significativo.
</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mtS</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## --------------------------------------------------------------
##       t-Student Heckman Model (Package: ssmodels)             
## --------------------------------------------------------------
## --------------------------------------------------------------
## Maximum Likelihood estimation 
## optim function with method BFGS-iterations numbers: 25 
## Log-Likelihood: -5822.076 
## AIC: 11680.15 BIC: 11790.13 
## Number of observations: ( 526 censored and 2802 observed ) 
## 18 free parameters ( df= 3310 ) 
## --------------------------------------------------------------
## Probit selection equation:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.747972   0.207700  -3.601 0.000321 ***
## age          0.098549   0.029746   3.313 0.000933 ***
## female       0.724862   0.068559  10.573  &lt; 2e-16 ***
## educ         0.064839   0.012805   5.063 4.34e-07 ***
## blhisp      -0.393569   0.066529  -5.916 3.64e-09 ***
## totchr       0.890081   0.087252  10.201  &lt; 2e-16 ***
## ins          0.180029   0.068010   2.647 0.008157 ** 
## income       0.002978   0.001447   2.058 0.039636 *  
## --------------------------------------------------------------
## Outcome equation:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  5.20584    0.20961  24.835  &lt; 2e-16 ***
## age          0.20683    0.02260   9.152  &lt; 2e-16 ***
## female       0.30653    0.05640   5.435 5.87e-08 ***
## educ         0.01731    0.01026   1.688 0.091591 .  
## blhisp      -0.19297    0.05775  -3.342 0.000842 ***
## totchr       0.51271    0.03583  14.310  &lt; 2e-16 ***
## ins         -0.05250    0.05048  -1.040 0.298439    
## --------------------------------------------------------------
## Error terms:
##       Estimate Std. Error t value Pr(&gt;|t|)    
## sigma  1.19485    0.02365  50.524  &lt; 2e-16 ***
## rho   -0.32199    0.12210  -2.637   0.0084 ** 
## df    12.93032    2.85903   4.523 6.32e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------------------------</code></pre>
<p style="text-align: justify;">
Por fim, o modelo Heckman-Skew também indica presença de correlação significativa entre as variáveis de interesse e de seleção. Além disso, também indica desvio da normalidade dos dados transformados. É importante ressaltar que sem a transformação dos dados, o método iterativo de estimação dos parâmetros do modelo Heckman-Skew não converge.
</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mSK</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## --------------------------------------------------------------
##       Skew Normal Heckman Model (Package: ssmodels)           
## --------------------------------------------------------------
## --------------------------------------------------------------
## Maximum Likelihood estimation 
## optim function with method BFGS-iterations numbers: 79 
## Log-Likelihood: -5805.744 
## AIC: 11647.49 BIC: 11757.47 
## Number of observations: ( 526 censored and 2802 observed ) 
## 18 free parameters ( df= 3310 ) 
## --------------------------------------------------------------
## Probit selection equation:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.899099   0.205570  -4.374 1.26e-05 ***
## age          0.086608   0.026563   3.260  0.00112 ** 
## female       0.644807   0.061736  10.445  &lt; 2e-16 ***
## educ         0.060281   0.011774   5.120 3.23e-07 ***
## blhisp      -0.350940   0.060960  -5.757 9.35e-09 ***
## totchr       0.774834   0.072534  10.682  &lt; 2e-16 ***
## ins          0.169602   0.061055   2.778  0.00550 ** 
## income       0.002657   0.001278   2.079  0.03770 *  
## --------------------------------------------------------------
## Outcome equation:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  6.45165    0.22388  28.818  &lt; 2e-16 ***
## age          0.20218    0.02211   9.146  &lt; 2e-16 ***
## female       0.28739    0.05507   5.218 1.92e-07 ***
## educ         0.01334    0.01007   1.325 0.185146    
## blhisp      -0.20148    0.05637  -3.575 0.000356 ***
## totchr       0.49158    0.03589  13.696  &lt; 2e-16 ***
## ins         -0.08050    0.04979  -1.617 0.106042    
## --------------------------------------------------------------
## Error terms:
##        Estimate Std. Error t value Pr(&gt;|t|)    
## sigma    1.7359     0.0470  36.938   &lt;2e-16 ***
## rho     -0.3390     0.1411  -2.402   0.0164 *  
## lambda  -1.6620     0.1434 -11.587   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------------------------</code></pre>
</div>
<div id="nhanes-2003-2004" class="section level2">
<h2 class="hasAnchor">
<a href="#nhanes-2003-2004" class="anchor"></a>Nhanes 2003-2004</h2>
<p style="text-align: justify;">
The US National Health and Nutrition Examination Study (NHANES) is a survey data collected by the US National Center for Health Statistics. The survey data dates back to 1999, where individuals of all ages are interviewed in their home annually and complete the health examination component of the survey. The study variables include demographic variables (e.g. age and annual household income), physical measurements (e.g. BMI – body mass index), health variables (e.g. diabetes status), and lifestyle variables (e.g. smoking status). This data frame contains the following columns:
</p>
<ul>
<li>id: Individual identifier</li>
<li>age: Age</li>
<li>gender: Sex 1=male, 0=female</li>
<li>educ: Education is dichotomized into high school and above versus less than high school</li>
<li>race: categorical variable with five levels</li>
<li>income: Household income ($1000 per year) was reported as a range of values in dollar (e.g. 0–4999, 5000–9999, etc.)</li>
<li>and had 10 interval categories. *Income: Household income ($1000 per year) was reported as a range of values in dollar (e.g. 0–4999, 5000–9999, etc.)</li>
<li>and had 10 interval categories.</li>
<li>bmi: body mass index</li>
<li>sbp: systolic blood pressure</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ssmodels</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">nhanes</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span><span class="op">(</span><span class="va">nhanes</span><span class="op">)</span>
<span class="va">perc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">data</span><span class="op">)</span><span class="op">{</span>
    <span class="va">nna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">!=</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span>,<span class="fl">0</span><span class="op">)</span>
    <span class="va">perc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">!=</span><span class="fl">0</span>,<span class="op">(</span><span class="va">nna</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>,<span class="fl">0</span><span class="op">)</span>
   <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">perc</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">Variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SBP (mm Hg)"</span>, <span class="st">"Age (year)"</span>, <span class="st">"Gender"</span>, <span class="st">"BMI (Kg/$m^{2}$)"</span>, <span class="st">"Education (years)"</span>, <span class="st">"Race"</span>, <span class="st">"Income ($\\$1000$ per year)"</span>, <span class="st">"Numbers Obs."</span><span class="op">)</span>
<span class="va">perc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">sbp</span>,<span class="va">nhanes</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">perc2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">age</span>,<span class="va">nhanes</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">perc3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">gender</span>,<span class="va">nhanes</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">perc4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">bmi</span>,<span class="va">nhanes</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">perc5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">educ</span>,<span class="va">nhanes</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">perc6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">race</span>,<span class="va">nhanes</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">perc7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">Income</span>,<span class="va">nhanes</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">nObs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Income</span><span class="op">)</span>
<span class="va">Percentage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">perc1</span>, <span class="va">perc2</span>, <span class="va">perc3</span>, <span class="va">perc4</span>, <span class="va">perc5</span>, <span class="va">perc6</span>, <span class="va">perc7</span>, <span class="va">nObs</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nhanes</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">sbp</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">bmi</span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="va">perc11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">sbp</span>,<span class="va">df</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">perc12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">age</span>,<span class="va">df</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">perc13</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">gender</span>,<span class="va">df</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">perc14</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">bmi</span>,<span class="va">df</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">perc15</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">educ</span>,<span class="va">df</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">perc16</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">race</span>,<span class="va">df</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">perc17</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">perc</span><span class="op">(</span><span class="va">Income</span>,<span class="va">df</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">nObs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Income</span><span class="op">)</span>
<span class="va">Percentage1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">perc11</span>, <span class="va">perc12</span>, <span class="va">perc13</span>, <span class="va">perc14</span>, <span class="va">perc15</span>, <span class="va">perc16</span>, <span class="va">perc17</span>, <span class="va">nObs1</span><span class="op">)</span>
<span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Variables"</span> <span class="op">=</span> <span class="va">Variables</span>, <span class="st">"Percentage of Missing"</span><span class="op">=</span> <span class="va">Percentage</span>, <span class="st">"Without Missing"</span><span class="op">=</span> <span class="va">Percentage1</span><span class="op">)</span>
<span class="fu">kable</span><span class="op">(</span><span class="va">table</span>, format <span class="op">=</span> <span class="st">"html"</span>, align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:center;">
Variables
</th>
<th style="text-align:center;">
Percentage.of.Missing
</th>
<th style="text-align:center;">
Without.Missing
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
SBP (mm Hg)
</td>
<td style="text-align:center;">
34.94
</td>
<td style="text-align:center;">
0.00
</td>
</tr>
<tr>
<td style="text-align:center;">
Age (year)
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.00
</td>
</tr>
<tr>
<td style="text-align:center;">
Gender
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.00
</td>
</tr>
<tr>
<td style="text-align:center;">
BMI (Kg/<span class="math inline">\(m^{2}\)</span>)
</td>
<td style="text-align:center;">
9.91
</td>
<td style="text-align:center;">
0.00
</td>
</tr>
<tr>
<td style="text-align:center;">
Education (years)
</td>
<td style="text-align:center;">
17.22
</td>
<td style="text-align:center;">
0.00
</td>
</tr>
<tr>
<td style="text-align:center;">
Race
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.00
</td>
</tr>
<tr>
<td style="text-align:center;">
Income (<span class="math inline">\(\$1000\)</span> per year)
</td>
<td style="text-align:center;">
24.41
</td>
<td style="text-align:center;">
25.43
</td>
</tr>
<tr>
<td style="text-align:center;">
Numbers Obs.
</td>
<td style="text-align:center;">
9643.00
</td>
<td style="text-align:center;">
6193.00
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"gridExtra"</span><span class="op">)</span>
<span class="va">barfill</span> <span class="op">&lt;-</span> <span class="st">"grey"</span>
<span class="va">barlines</span> <span class="op">&lt;-</span> <span class="st">"black"</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Income</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span> breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, colour <span class="op">=</span> <span class="va">barlines</span>, fill <span class="op">=</span> <span class="va">barfill</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Income"</span>,
                   breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">2</span><span class="op">)</span>,
                   limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">sbp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span> colour <span class="op">=</span> <span class="va">barlines</span>, fill <span class="op">=</span> <span class="va">barfill</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Log Systolic blood pressure"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-15-1.png" width="691.2" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">$</span><span class="va">YS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Income</span><span class="op">)</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">educ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">educ</span><span class="op">&lt;=</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">Income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Income</span><span class="op">)</span>,<span class="fl">0</span>,<span class="va">df</span><span class="op">$</span><span class="va">Income</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="va">selectionEq</span> <span class="op">&lt;-</span> <span class="va">YS</span><span class="op">~</span><span class="va">age</span><span class="op">+</span><span class="va">gender</span><span class="op">+</span><span class="va">educ</span><span class="op">+</span><span class="va">race</span>
<span class="va">outcomeEq</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">sbp</span><span class="op">)</span><span class="op">~</span><span class="va">age</span><span class="op">+</span><span class="va">gender</span><span class="op">+</span><span class="va">educ</span><span class="op">+</span><span class="va">bmi</span><span class="op">+</span><span class="va">Income</span>
<span class="va">outcomeBS</span>   <span class="op">&lt;-</span> <span class="va">sbp</span><span class="op">~</span><span class="va">age</span><span class="op">+</span><span class="va">gender</span><span class="op">+</span><span class="va">educ</span><span class="op">+</span><span class="va">bmi</span><span class="op">+</span><span class="va">Income</span>
<span class="va">mCL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmanCL.html">HeckmanCL</a></span><span class="op">(</span><span class="va">selectionEq</span>, <span class="va">outcomeEq</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="va">mBS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmanBS.html">HeckmanBS</a></span><span class="op">(</span><span class="va">selectionEq</span>, <span class="va">outcomeBS</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span>
<span class="va">mSK</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmanSK.html">HeckmanSK</a></span><span class="op">(</span><span class="va">selectionEq</span>, <span class="va">outcomeEq</span>, data <span class="op">=</span> <span class="va">df</span>, lambda <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">mtS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/HeckmantS.html">HeckmantS</a></span><span class="op">(</span><span class="va">selectionEq</span>, <span class="va">outcomeEq</span>, data <span class="op">=</span> <span class="va">df</span>, df <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>

    <span class="va">Parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"age"</span>, <span class="st">"gender"</span>, <span class="st">"educ"</span>, <span class="st">"race"</span>, <span class="st">"Intercept"</span>, <span class="st">"age"</span>, <span class="st">"gender"</span>, <span class="st">"educ"</span>, <span class="st">"bmi"</span>, <span class="st">"income"</span>, <span class="st">"sigma"</span>, <span class="st">"rho"</span>, <span class="st">"nu"</span>, <span class="st">"lambda"</span><span class="op">)</span>
<span class="va">HBS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mBS</span><span class="op">$</span><span class="va">coefficients</span>, digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">HCL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mCL</span><span class="op">$</span><span class="va">coefficients</span>, digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">HSK</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mSK</span><span class="op">$</span><span class="va">coefficients</span>, digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">HtS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mtS</span><span class="op">$</span><span class="va">coefficients</span>, digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">Results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">"Parameters"</span><span class="op">=</span> <span class="va">Parameters</span>, 
                      <span class="st">"HeckmanCL"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">HCL</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span><span class="op">)</span>,
                      <span class="st">"HeckmanBS"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">HBS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span><span class="op">)</span>, 
                      <span class="st">"HeckmantS"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">HtS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span>, <span class="va">HtS</span><span class="op">[</span><span class="fl">14</span><span class="op">]</span>, <span class="st">"NA"</span><span class="op">)</span>,
                      <span class="st">"HeckmanSK"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">HSK</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span>, <span class="st">"NA"</span>, <span class="va">HSK</span><span class="op">[</span><span class="fl">14</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="fu">kable</span><span class="op">(</span><span class="va">Results</span>, format <span class="op">=</span> <span class="st">"html"</span>, align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:center;">
Parameters
</th>
<th style="text-align:center;">
HeckmanCL
</th>
<th style="text-align:center;">
HeckmanBS
</th>
<th style="text-align:center;">
HeckmantS
</th>
<th style="text-align:center;">
HeckmanSK
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
Intercept
</td>
<td style="text-align:center;">
0.44001
</td>
<td style="text-align:center;">
1.35518
</td>
<td style="text-align:center;">
0.50396
</td>
<td style="text-align:center;">
0.83765
</td>
</tr>
<tr>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
0.01113
</td>
<td style="text-align:center;">
0.01349
</td>
<td style="text-align:center;">
0.01079
</td>
<td style="text-align:center;">
0.01066
</td>
</tr>
<tr>
<td style="text-align:center;">
gender
</td>
<td style="text-align:center;">
0.13624
</td>
<td style="text-align:center;">
0.15098
</td>
<td style="text-align:center;">
0.1373
</td>
<td style="text-align:center;">
0.12074
</td>
</tr>
<tr>
<td style="text-align:center;">
educ
</td>
<td style="text-align:center;">
-0.53594
</td>
<td style="text-align:center;">
-0.67172
</td>
<td style="text-align:center;">
-0.55715
</td>
<td style="text-align:center;">
-0.42047
</td>
</tr>
<tr>
<td style="text-align:center;">
race
</td>
<td style="text-align:center;">
-0.07011
</td>
<td style="text-align:center;">
-0.09013
</td>
<td style="text-align:center;">
-0.07708
</td>
<td style="text-align:center;">
-0.04967
</td>
</tr>
<tr>
<td style="text-align:center;">
Intercept
</td>
<td style="text-align:center;">
4.51594
</td>
<td style="text-align:center;">
4.52773
</td>
<td style="text-align:center;">
4.52781
</td>
<td style="text-align:center;">
4.63651
</td>
</tr>
<tr>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
0.00448
</td>
<td style="text-align:center;">
0.00448
</td>
<td style="text-align:center;">
0.00435
</td>
<td style="text-align:center;">
0.00481
</td>
</tr>
<tr>
<td style="text-align:center;">
gender
</td>
<td style="text-align:center;">
-0.0229
</td>
<td style="text-align:center;">
-0.02355
</td>
<td style="text-align:center;">
-0.02622
</td>
<td style="text-align:center;">
-0.02081
</td>
</tr>
<tr>
<td style="text-align:center;">
educ
</td>
<td style="text-align:center;">
-0.04788
</td>
<td style="text-align:center;">
-0.0474
</td>
<td style="text-align:center;">
-0.04532
</td>
<td style="text-align:center;">
-0.05107
</td>
</tr>
<tr>
<td style="text-align:center;">
bmi
</td>
<td style="text-align:center;">
0.00362
</td>
<td style="text-align:center;">
0.00361
</td>
<td style="text-align:center;">
0.00367
</td>
<td style="text-align:center;">
0.00365
</td>
</tr>
<tr>
<td style="text-align:center;">
income
</td>
<td style="text-align:center;">
0.00044
</td>
<td style="text-align:center;">
4e-04
</td>
<td style="text-align:center;">
0.00049
</td>
<td style="text-align:center;">
0.00034
</td>
</tr>
<tr>
<td style="text-align:center;">
sigma
</td>
<td style="text-align:center;">
0.14354
</td>
<td style="text-align:center;">
96.68214
</td>
<td style="text-align:center;">
0.13023
</td>
<td style="text-align:center;">
0.21735
</td>
</tr>
<tr>
<td style="text-align:center;">
rho
</td>
<td style="text-align:center;">
0.77446
</td>
<td style="text-align:center;">
0.77208
</td>
<td style="text-align:center;">
0.7398
</td>
<td style="text-align:center;">
0.90901
</td>
</tr>
<tr>
<td style="text-align:center;">
nu
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
14.40706
</td>
<td style="text-align:center;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;">
lambda
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
-1.62376
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mCL</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## --------------------------------------------------------------
##           Classic Heckman Model (Package: ssmodels)           
## --------------------------------------------------------------
## --------------------------------------------------------------
## Maximum Likelihood estimation 
## optim function with method BFGS-iterations numbers: 27 
## Log-Likelihood: -216.546 
## AIC: 459.0919 BIC: 546.5972 
## Number of observations: ( 1575 censored and 4618 observed ) 
## 13 free parameters ( df= 6180 ) 
## --------------------------------------------------------------
## Probit selection equation:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.4400117  0.0751789   5.853 5.08e-09 ***
## age          0.0111345  0.0008816  12.630  &lt; 2e-16 ***
## gender       0.1362360  0.0344494   3.955 7.75e-05 ***
## educ        -0.5359397  0.0384988 -13.921  &lt; 2e-16 ***
## race        -0.0701069  0.0134076  -5.229 1.76e-07 ***
## --------------------------------------------------------------
## Outcome equation:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.516e+00  1.080e-02 418.113  &lt; 2e-16 ***
## age          4.477e-03  9.126e-05  49.064  &lt; 2e-16 ***
## gender      -2.290e-02  4.027e-03  -5.687 1.35e-08 ***
## educ        -4.788e-02  4.864e-03  -9.844  &lt; 2e-16 ***
## bmi          3.623e-03  2.905e-04  12.474  &lt; 2e-16 ***
## Income       4.369e-04  7.609e-04   0.574    0.566    
## --------------------------------------------------------------
## Error terms:
##       Estimate Std. Error t value Pr(&gt;|t|)    
## sigma 0.143541   0.002325   61.74   &lt;2e-16 ***
## rho   0.774464   0.022220   34.85   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mtS</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## --------------------------------------------------------------
##       t-Student Heckman Model (Package: ssmodels)             
## --------------------------------------------------------------
## --------------------------------------------------------------
## Maximum Likelihood estimation 
## optim function with method BFGS-iterations numbers: 100 
## Log-Likelihood: -172.8373 
## AIC: 373.6746 BIC: 467.911 
## Number of observations: ( 1575 censored and 4618 observed ) 
## 14 free parameters ( df= 6179 ) 
## --------------------------------------------------------------
## Probit selection equation:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.503962   0.079702   6.323 2.74e-10 ***
## age          0.010794   0.001004  10.747  &lt; 2e-16 ***
## gender       0.137302   0.036467   3.765 0.000168 ***
## educ        -0.557147   0.040707 -13.687  &lt; 2e-16 ***
## race        -0.077080   0.014286  -5.395 7.09e-08 ***
## --------------------------------------------------------------
## Outcome equation:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.528e+00  1.044e-02 433.844  &lt; 2e-16 ***
## age          4.348e-03  8.977e-05  48.436  &lt; 2e-16 ***
## gender      -2.622e-02  3.844e-03  -6.822  9.8e-12 ***
## educ        -4.532e-02  4.959e-03  -9.139  &lt; 2e-16 ***
## bmi          3.672e-03  2.854e-04  12.864  &lt; 2e-16 ***
## Income       4.896e-04  7.432e-04   0.659     0.51    
## --------------------------------------------------------------
## Error terms:
##        Estimate Std. Error t value Pr(&gt;|t|)    
## sigma  0.130226   0.001353   96.26   &lt;2e-16 ***
## rho    0.739803   0.050805   14.56   &lt;2e-16 ***
## df    14.407064   1.097547   13.13   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mBS</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## --------------------------------------------------------------
##    Birnbaum-Saunders Heckman Model (Package: ssmodels)        
## --------------------------------------------------------------
## --------------------------------------------------------------
## Maximum Likelihood estimation 
## optim function with method BFGS-iterations numbers: 76 
## Log-Likelihood: -22281.19 
## AIC: 44588.38 BIC: 44675.89 
## Number of observations: ( 1575 censored and 4618 observed ) 
## 13 free parameters ( df= 6180 ) 
## --------------------------------------------------------------
## Probit selection equation:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.355185   0.094721  14.307  &lt; 2e-16 ***
## age          0.013492   0.001039  12.984  &lt; 2e-16 ***
## gender       0.150982   0.043582   3.464 0.000535 ***
## educ        -0.671716   0.049316 -13.621  &lt; 2e-16 ***
## race        -0.090127   0.016965  -5.313 1.12e-07 ***
## --------------------------------------------------------------
## Outcome equation:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.528e+00  1.072e-02 422.194  &lt; 2e-16 ***
## age          4.478e-03  9.105e-05  49.182  &lt; 2e-16 ***
## gender      -2.355e-02  4.029e-03  -5.844 5.36e-09 ***
## educ        -4.740e-02  4.851e-03  -9.772  &lt; 2e-16 ***
## bmi          3.610e-03  2.907e-04  12.418  &lt; 2e-16 ***
## Income       3.974e-04  7.621e-04   0.522    0.602    
## --------------------------------------------------------------
## Error terms:
##       Estimate Std. Error t value Pr(&gt;|t|)    
## sigma 96.68214    3.15376   30.66   &lt;2e-16 ***
## rho    0.77208    0.02258   34.20   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mSK</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## --------------------------------------------------------------
##       Skew Normal Heckman Model (Package: ssmodels)           
## --------------------------------------------------------------
## --------------------------------------------------------------
## Maximum Likelihood estimation 
## optim function with method BFGS-iterations numbers: 45 
## Log-Likelihood: -202.82 
## AIC: 433.6401 BIC: 527.8765 
## Number of observations: ( 1575 censored and 4618 observed ) 
## 14 free parameters ( df= 6179 ) 
## --------------------------------------------------------------
## Probit selection equation:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.8376493  0.0577195  14.512  &lt; 2e-16 ***
## age          0.0106572  0.0006882  15.486  &lt; 2e-16 ***
## gender       0.1207434  0.0271668   4.445 8.96e-06 ***
## educ        -0.4204717  0.0331856 -12.670  &lt; 2e-16 ***
## race        -0.0496700  0.0105806  -4.694 2.73e-06 ***
## --------------------------------------------------------------
## Outcome equation:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.6365130  0.0122797 377.575  &lt; 2e-16 ***
## age          0.0048084  0.0001139  42.199  &lt; 2e-16 ***
## gender      -0.0208051  0.0041517  -5.011 5.56e-07 ***
## educ        -0.0510738  0.0048687 -10.490  &lt; 2e-16 ***
## bmi          0.0036457  0.0002900  12.571  &lt; 2e-16 ***
## Income       0.0003417  0.0007569   0.451    0.652    
## --------------------------------------------------------------
## Error terms:
##        Estimate Std. Error t value Pr(&gt;|t|)    
## sigma   0.21735    0.01093  19.885   &lt;2e-16 ***
## rho     0.90901    0.01496  60.747   &lt;2e-16 ***
## lambda -1.62376    0.18321  -8.863   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## --------------------------------------------------------------</code></pre>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-colin2009microeconometrics">
<p>Colin, Cameron A, and Pravin K Trivedi. 2009. “Microeconometrics Using Stata.” <em>Lakeway Drive, TX: Stata Press Books</em>.</p>
</div>
<div id="ref-mvtnorm">
<p>Genz, Alan, Frank Bretz, Tetsuhisa Miwa, Xuefei Mi, Friedrich Leisch, Fabian Scheipl, and Torsten Hothorn. 2019. <em>mvtnorm: Multivariate Normal and T Distributions</em>. <a href="https://CRAN.R-project.org/package=mvtnorm">https://CRAN.R-project.org/package=mvtnorm</a>.</p>
</div>
<div id="ref-heckman1976common">
<p>Heckman, James J. 1976. “The Common Structure of Statistical Models of Truncation, Sample Selection and Limited Dependent Variables and a Simple Estimator for Such Models.” In <em>Annals of Economic and Social Measurement, Volume 5, Number 4</em>, 475–92. NBER.</p>
</div>
<div id="ref-heckman1979sample">
<p>———. 1979. “Sample Selection Bias as a Specification Error.” <em>Econometrica: Journal of the Econometric Society</em>, 153–61.</p>
</div>
<div id="ref-marchenko2012heckman">
<p>Marchenko, Yulia V, and Marc G Genton. 2012. “A Heckman Selection-T Model.” <em>Journal of the American Statistical Association</em> 107 (497): 304–17.</p>
</div>
<div id="ref-ogundimu2016sample">
<p>Ogundimu, Emmanuel O, and Jane L Hutton. 2016. “A Sample Selection Model with Skew-Normal Distribution.” <em>Scandinavian Journal of Statistics</em> 43 (1): 172–90.</p>
</div>
<div id="ref-sampleSelection">
<p>Toomet, Ott, and Arne Henningsen. 2008. “Sample Selection Models in R: Package sampleSelection.” <em>Journal of Statistical Software</em> 27 (7). <a href="http://www.jstatsoft.org/v27/i07/">http://www.jstatsoft.org/v27/i07/</a>.</p>
</div>
<div id="ref-zhelonkin2016robust">
<p>Zhelonkin, Mikhail, Marc G Genton, and Elvezio Ronchetti. 2016. “Robust Inference in Sample Selection Models.” <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 78 (4): 805–27.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Fernando de Souza Bastos, Wagner Barreto de Souza.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
