<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generalized Heckman Model Estimation — HeckmanGe • ssmodels</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Heckman Model Estimation — HeckmanGe"><meta property="og:description" content="Fits a generalized Heckman sample selection model that allows for heteroskedasticity
in the outcome equation and correlation of the error terms depending on covariates.
The estimation is performed via Maximum Likelihood using the BFGS algorithm."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ssmodels</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/vignette.html">ssmodels: A package for fit the sample selection models</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fsbmat-ufv/ssmodels/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generalized Heckman Model Estimation</h1>
    <small class="dont-index">Source: <a href="https://github.com/fsbmat-ufv/ssmodels/blob/HEAD/R/HeckmanGe.R" class="external-link"><code>R/HeckmanGe.R</code></a></small>
    <div class="hidden name"><code>HeckmanGe.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a generalized Heckman sample selection model that allows for heteroskedasticity
in the outcome equation and correlation of the error terms depending on covariates.
The estimation is performed via Maximum Likelihood using the BFGS algorithm.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">HeckmanGe</span><span class="op">(</span></span>
<span>  <span class="va">selection</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  <span class="va">outcomeS</span>,</span>
<span>  <span class="va">outcomeC</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">sys.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">sys.parent</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-selection">selection<a class="anchor" aria-label="anchor" href="#arg-selection"></a></dt>
<dd><p>A formula specifying the selection equation.</p></dd>


<dt id="arg-outcome">outcome<a class="anchor" aria-label="anchor" href="#arg-outcome"></a></dt>
<dd><p>A formula specifying the outcome equation.</p></dd>


<dt id="arg-outcomes">outcomeS<a class="anchor" aria-label="anchor" href="#arg-outcomes"></a></dt>
<dd><p>A formula or matrix specifying covariates for the scale (variance) model.</p></dd>


<dt id="arg-outcomec">outcomeC<a class="anchor" aria-label="anchor" href="#arg-outcomec"></a></dt>
<dd><p>A formula or matrix specifying covariates for the correlation model.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the variables in the model.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>An optional numeric vector with starting values for the optimization.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing:</p><ul><li><p><code>coefficients</code>: Named vector of estimated model parameters.</p></li>
<li><p><code>value</code>: Negative of the maximum log-likelihood.</p></li>
<li><p><code>loglik</code>: Maximum log-likelihood.</p></li>
<li><p><code>counts</code>: Number of gradient evaluations performed.</p></li>
<li><p><code>hessian</code>: Hessian matrix at the optimum.</p></li>
<li><p><code>fisher_infoHG</code>: Approximate Fisher information matrix.</p></li>
<li><p><code>prop_sigmaHG</code>: Standard errors for the parameter estimates.</p></li>
<li><p><code>level</code>: Levels of the selection variable.</p></li>
<li><p><code>nObs</code>: Number of observations in the dataset.</p></li>
<li><p><code>nParam</code>: Number of estimated parameters.</p></li>
<li><p><code>N0</code>: Number of censored (unobserved) observations.</p></li>
<li><p><code>N1</code>: Number of uncensored (observed) observations.</p></li>
<li><p><code>NXS</code>: Number of covariates in the selection equation.</p></li>
<li><p><code>NXO</code>: Number of covariates in the outcome equation.</p></li>
<li><p><code>df</code>: Degrees of freedom (observations minus parameters).</p></li>
<li><p><code>aic</code>: Akaike Information Criterion.</p></li>
<li><p><code>bic</code>: Bayesian Information Criterion.</p></li>
<li><p><code>initial.value</code>: Starting values used for optimization.</p></li>
<li><p><code>NE</code>: Number of parameters in the scale model.</p></li>
<li><p><code>NV</code>: Number of parameters in the correlation model.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function extends the classical Heckman selection model by incorporating models
for the error term's variance (scale) and the correlation between the selection and outcome equations.
The scale model (<code>outcomeS</code>) allows the error variance of the outcome equation
to depend on covariates, while the correlation model (<code>outcomeC</code>) allows
the error correlation to vary with covariates.</p>
<p>The optimization is initialized with default or user-supplied starting values,
and the results include robust standard errors derived from the inverse of the observed
Fisher information matrix.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Fernando
de
Souza Bastos, Wagner Barreto-Souza, Marc
G Genton (2022).
“A Generalized Heckman Model With Varying Sample Selection Bias and Dispersion Parameters.”
<em>Statistica Sinica</em>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">MEPS2001</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">MEPS2001</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">selectEq</span> <span class="op">&lt;-</span> <span class="va">dambexp</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">blhisp</span> <span class="op">+</span> <span class="va">totchr</span> <span class="op">+</span> <span class="va">ins</span> <span class="op">+</span> <span class="va">income</span></span></span>
<span class="r-in"><span><span class="va">outcomeEq</span> <span class="op">&lt;-</span> <span class="va">lnambx</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">blhisp</span> <span class="op">+</span> <span class="va">totchr</span> <span class="op">+</span> <span class="va">ins</span></span></span>
<span class="r-in"><span><span class="va">outcomeS</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">income</span></span></span>
<span class="r-in"><span><span class="va">outcomeC</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">blhisp</span> <span class="op">+</span> <span class="va">female</span></span></span>
<span class="r-in"><span><span class="fu">HeckmanGe</span><span class="op">(</span><span class="va">selectEq</span>, <span class="va">outcomeEq</span>, outcomeS <span class="op">=</span> <span class="va">outcomeS</span>, outcomeC <span class="op">=</span> <span class="va">outcomeC</span>, data <span class="op">=</span> <span class="va">MEPS2001</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Fernando de Souza Bastos, Wagner Barreto de Souza.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

