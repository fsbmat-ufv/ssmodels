<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generalized Heckman Model Estimation — HeckmanGe • ssmodels</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Heckman Model Estimation — HeckmanGe"><meta name="description" content="Fits a generalized Heckman sample selection model that allows for heteroskedasticity
in the outcome equation and correlation of the error terms depending on covariates.
The estimation is performed via Maximum Likelihood using the BFGS algorithm."><meta property="og:description" content="Fits a generalized Heckman sample selection model that allows for heteroskedasticity
in the outcome equation and correlation of the error terms depending on covariates.
The estimation is performed via Maximum Likelihood using the BFGS algorithm."><meta property="og:image" content="https://fsbmat-ufv.github.io/ssmodels/logo.png"><style>
  .navbar-brand img {
    max-height: 80px;
    width: auto;
  }
</style></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ssmodels</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vignette.html">ssmodels: A package for fit the sample selection models</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fsbmat-ufv/ssmodels/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generalized Heckman Model Estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/fsbmat-ufv/ssmodels/blob/main/R/HeckmanGe.R" class="external-link"><code>R/HeckmanGe.R</code></a></small>
      <div class="d-none name"><code>HeckmanGe.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a generalized Heckman sample selection model that allows for heteroskedasticity
in the outcome equation and correlation of the error terms depending on covariates.
The estimation is performed via Maximum Likelihood using the BFGS algorithm.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">HeckmanGe</span><span class="op">(</span></span>
<span>  <span class="va">selection</span>,</span>
<span>  <span class="va">outcome</span>,</span>
<span>  <span class="va">outcomeS</span>,</span>
<span>  <span class="va">outcomeC</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">sys.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">sys.parent</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-selection">selection<a class="anchor" aria-label="anchor" href="#arg-selection"></a></dt>
<dd><p>A formula specifying the selection equation.</p></dd>


<dt id="arg-outcome">outcome<a class="anchor" aria-label="anchor" href="#arg-outcome"></a></dt>
<dd><p>A formula specifying the outcome equation.</p></dd>


<dt id="arg-outcomes">outcomeS<a class="anchor" aria-label="anchor" href="#arg-outcomes"></a></dt>
<dd><p>A formula or matrix specifying covariates for the scale (variance) model.</p></dd>


<dt id="arg-outcomec">outcomeC<a class="anchor" aria-label="anchor" href="#arg-outcomec"></a></dt>
<dd><p>A formula or matrix specifying covariates for the correlation model.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the variables in the model.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>An optional numeric vector with starting values for the optimization.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><ul><li><p><code>coefficients</code>: Named vector of estimated model parameters.</p></li>
<li><p><code>value</code>: Negative of the maximum log-likelihood.</p></li>
<li><p><code>loglik</code>: Maximum log-likelihood.</p></li>
<li><p><code>counts</code>: Number of gradient evaluations performed.</p></li>
<li><p><code>hessian</code>: Hessian matrix at the optimum.</p></li>
<li><p><code>fisher_infoHG</code>: Approximate Fisher information matrix.</p></li>
<li><p><code>prop_sigmaHG</code>: Standard errors for the parameter estimates.</p></li>
<li><p><code>level</code>: Levels of the selection variable.</p></li>
<li><p><code>nObs</code>: Number of observations in the dataset.</p></li>
<li><p><code>nParam</code>: Number of estimated parameters.</p></li>
<li><p><code>N0</code>: Number of censored (unobserved) observations.</p></li>
<li><p><code>N1</code>: Number of uncensored (observed) observations.</p></li>
<li><p><code>NXS</code>: Number of covariates in the selection equation.</p></li>
<li><p><code>NXO</code>: Number of covariates in the outcome equation.</p></li>
<li><p><code>df</code>: Degrees of freedom (observations minus parameters).</p></li>
<li><p><code>aic</code>: Akaike Information Criterion.</p></li>
<li><p><code>bic</code>: Bayesian Information Criterion.</p></li>
<li><p><code>initial.value</code>: Starting values used for optimization.</p></li>
<li><p><code>NE</code>: Number of parameters in the scale model.</p></li>
<li><p><code>NV</code>: Number of parameters in the correlation model.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function extends the classical Heckman selection model by incorporating models
for the error term's variance (scale) and the correlation between the selection and outcome equations.
The scale model (<code>outcomeS</code>) allows the error variance of the outcome equation
to depend on covariates, while the correlation model (<code>outcomeC</code>) allows
the error correlation to vary with covariates.</p>
<p>The optimization is initialized with default or user-supplied starting values,
and the results include robust standard errors derived from the inverse of the observed
Fisher information matrix.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fernando
de
Souza Bastos, Wagner Barreto-Souza, Marc
G Genton (2022).
“A Generalized Heckman Model With Varying Sample Selection Bias and Dispersion Parameters.”
<em>Statistica Sinica</em>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">MEPS2001</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">MEPS2001</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">selectEq</span> <span class="op">&lt;-</span> <span class="va">dambexp</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">blhisp</span> <span class="op">+</span> <span class="va">totchr</span> <span class="op">+</span> <span class="va">ins</span> <span class="op">+</span> <span class="va">income</span></span></span>
<span class="r-in"><span><span class="va">outcomeEq</span> <span class="op">&lt;-</span> <span class="va">lnambx</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">blhisp</span> <span class="op">+</span> <span class="va">totchr</span> <span class="op">+</span> <span class="va">ins</span></span></span>
<span class="r-in"><span><span class="va">outcomeS</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">income</span></span></span>
<span class="r-in"><span><span class="va">outcomeC</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">blhisp</span> <span class="op">+</span> <span class="va">female</span></span></span>
<span class="r-in"><span><span class="fu">HeckmanGe</span><span class="op">(</span><span class="va">selectEq</span>, <span class="va">outcomeEq</span>, outcomeS <span class="op">=</span> <span class="va">outcomeS</span>, outcomeC <span class="op">=</span> <span class="va">outcomeC</span>, data <span class="op">=</span> <span class="va">MEPS2001</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Fernando de Souza Bastos, Wagner Barreto de Souza.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

